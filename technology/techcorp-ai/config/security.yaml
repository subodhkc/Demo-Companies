# Security Configuration
# ISO 27001: A.10.1.1 - Cryptographic controls policy
# SOC 2: CC6.1 - Security configuration management

authentication:
  jwt:
    algorithm: HS256
    access_token_expire_minutes: 30
    refresh_token_expire_days: 7
    secret_rotation_days: 90
  
  mfa:
    enabled: true
    required_for_admin: true
    totp_interval: 30
    totp_digits: 6
    backup_codes_count: 10
  
  password_policy:
    min_length: 12
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_special_chars: true
    max_age_days: 90
    history_count: 5

encryption:
  algorithm: AES-256-GCM
  key_derivation: PBKDF2
  pbkdf2_iterations: 100000
  key_rotation_days: 90
  
  tls:
    min_version: "1.3"
    cipher_suites:
      - TLS_AES_256_GCM_SHA384
      - TLS_CHACHA20_POLY1305_SHA256
      - TLS_AES_128_GCM_SHA256

session:
  timeout_minutes: 30
  absolute_timeout_hours: 8
  secure_cookie: true
  http_only: true
  same_site: strict
  
rate_limiting:
  enabled: true
  default_per_minute: 60
  default_per_hour: 1000
  auth_endpoints_per_minute: 5
  api_endpoints_per_minute: 100

audit:
  enabled: true
  log_level: INFO
  retention_days: 90
  encryption_enabled: true
  tamper_detection: true
  
  events_to_log:
    - authentication
    - authorization
    - data_access
    - data_modification
    - configuration_changes
    - security_alerts

security_headers:
  strict_transport_security: "max-age=31536000; includeSubDomains"
  x_frame_options: DENY
  x_content_type_options: nosniff
  x_xss_protection: "1; mode=block"
  content_security_policy: "default-src 'self'"
  referrer_policy: strict-origin-when-cross-origin

cors:
  allowed_origins:
    - https://techcorp.ai
    - https://app.techcorp.ai
  allowed_methods:
    - GET
    - POST
    - PUT
    - DELETE
  allowed_headers:
    - "*"
  expose_headers:
    - Content-Length
    - X-Request-ID
  max_age: 3600

input_validation:
  max_request_size_mb: 10
  sanitize_html: true
  strip_dangerous_chars: true
  validate_content_type: true
